'''
所有模型 的收敛图
'''
import numpy as np
import matplotlib.pyplot as plt

our_APE = [0.025867823796146664, 0.024303371002050964, 0.017559439128588053, 0.018395993527609948, 0.016846345244976114,
           0.016346209570919434, 0.016763963055419773, 0.0168439055492809, 0.016263994030377343, 0.01649010081752396,
           0.016391686267750567, 0.016170213237589548, 0.016078552477492774, 0.016053649496810495, 0.016283009516860337,
           0.016329444560014512, 0.01598195643510577, 0.0159881548024714, 0.0159398231285909, 0.01607845328779014,
           0.016008391603057788, 0.015962750246856085, 0.016332038093265916, 0.01618667657310066, 0.016350238022109692,
           0.015887456103266518, 0.015863856535466497, 0.01589556095721431, 0.01596360824124749, 0.015850540693110423,
           0.015930503737643237, 0.016123313984010092, 0.016226223681491514, 0.016317188705140647, 0.015944291418033444,
           0.015880614823146053, 0.01583735851478601, 0.01591677058965337, 0.015909481451130848, 0.015882456440416987,
           0.01597981671764215, 0.015826808350268475, 0.015836426195465336, 0.0159192074759871, 0.015878514940888922,
           0.015831513299552864, 0.01583408632061698, 0.015893856544540196, 0.015944585954570326, 0.01592765504124859,
           0.01571441239731248, 0.015757684314946743, 0.016495218331163578, 0.01595489695006289, 0.015732814126825038,
           0.015619812421654621, 0.015785285056191534, 0.015773888050062843, 0.015802423565933282, 0.01566372141395965,
           0.01568737925099563, 0.01601852700191219, 0.016150193169620658, 0.015711965277975748, 0.015710373093520313,
           0.01565456425016823, 0.015852789606221697, 0.01569056864212121, 0.01556870721911719, 0.015562841276184094,
           0.015613881840316717, 0.015554601418947385, 0.0155711531646796, 0.015616231470961462, 0.015600018191713192,
           0.015624166781867831, 0.01564491453218805, 0.01603138641154101, 0.015569605625981142, 0.015589819647648856,
           0.01575518934025375, 0.015614010289711646, 0.015617061914368109, 0.015779153613204307, 0.015559495957799194,
           0.016159419124284067, 0.015814245335973243, 0.015685405355131576, 0.015649724478471624, 0.015593004763157161,
           0.01594443352554332, 0.015738680939505662, 0.015582277224022003, 0.015851954556231902, 0.015616348321157053,
           0.015661667974681156, 0.015537796915347173, 0.015534688379954208, 0.015692604705691338, 0.015636071208710512]
our_APE_1 = [0.03759705702780011, 0.02463659802625268, 0.021356644388481078, 0.017019318686663242, 0.01671768564395375, 0.016483254951480814, 0.016398853752530695, 0.016356371212982057, 0.016246408309910917, 0.016104696975060687, 0.016156229707287088, 0.016020852074559246, 0.016022614687372684, 0.015960603447218367, 0.015954417302842035, 0.015914207527811173, 0.01586985694896237, 0.015871606244152223, 0.015858447688244143, 0.015837721734868814, 0.01579110626146722, 0.01583271711008087, 0.015791907350245406, 0.015803140493622726, 0.015776854177154062, 0.015762205041875567, 0.015773675680222227, 0.01572451588464419, 0.015729700487037625, 0.015717021211804377, 0.015754044049190008, 0.01574570271832479, 0.015692729027614028, 0.015741276351337787, 0.01572943318396128, 0.015720011194007122, 0.015700139956622082, 0.01573199611619948, 0.015670930820191376, 0.015651301295722123, 0.01570552795851607, 0.015692065387007858, 0.015656199446044416, 0.015637529037283507, 0.015664533995415852, 0.015677067274748352, 0.015660153642127108, 0.015629077820959607, 0.015635312635135328, 0.015585740160497819, 0.015605708454035638, 0.015584258284558606, 0.015583213116958212, 0.015537546992911254, 0.015504338578022168, 0.015543427485606285, 0.015544602095957375, 0.015521581274096702, 0.015498631748546293, 0.015518881530957932, 0.015487726395043465, 0.015497045524950539, 0.015526414211592628, 0.015509404288315626, 0.015495294272151485, 0.015465092139538401, 0.015494037454265246, 0.01548438099180165, 0.015469303680487425, 0.015464601453054333, 0.015441598755347988, 0.015446265391025915, 0.015480447622251313, 0.015443686166427273, 0.015474718691700178, 0.015463623412986967, 0.015437732888366371, 0.015450614669377574, 0.01544253279283396, 0.015436974018580796, 0.015454607636823972, 0.015463345525998384, 0.015418888295289153, 0.015447721719225063, 0.015461825438838754, 0.015487690885719028, 0.015434362293138144, 0.015456024310541943, 0.015434338124064, 0.015425028883915696, 0.015468922542990426, 0.015467982373815454, 0.015403684208412533, 0.01544674902992404, 0.015458214008027599, 0.01543152763259522, 0.01542369705214171, 0.015458565175448453, 0.01541975359808399, 0.015417395415089206]



rnn = [0.04467719620909573, 0.0438680887868828, 0.043624650348316536, 0.04352115964409241, 0.04356502412148744,
       0.04355910857600614, 0.04347072092215877, 0.04344590316134051, 0.043359671511556494, 0.04347001679611107,
       0.04332889811990182, 0.04335964446471743, 0.04337115970648025, 0.04340648218558347, 0.04330403271539152,
       0.04333677504611902, 0.0432993472853968, 0.04333902729197967, 0.04332686201784729, 0.04332952666258024,
       0.043411606322389, 0.04332692807247816, 0.04331888894219536, 0.043329923683084734, 0.043306534078495565,
       0.043303732921885066, 0.04330098274941287, 0.04330687094017986, 0.043326453605959235, 0.04330520430379663,
       0.043297323683076656, 0.043304892657093766, 0.043298402616430906, 0.043298417394442006, 0.04330564276430725,
       0.04330072570438227, 0.043311349832075685, 0.043322212224410586, 0.04332910972254828, 0.04333533716103262,
       0.043319982930648426, 0.04332157010443447, 0.04329383636493821, 0.04331103807761649, 0.04330345637295857,
       0.04333552279440332, 0.043298626626449184, 0.04330266990568027, 0.043298732858797734, 0.04332128850635418,
       0.043317990854751964, 0.04338079918760899, 0.043298580506739535, 0.043306090461074816, 0.04331035247026396,
       0.04330277772358626, 0.04332337993358778, 0.04333444604696321, 0.04330024908273673, 0.043295887214216316,
       0.043310384997282146, 0.04330813011908827, 0.043335099712260496, 0.04331222073413617, 0.043301114766312036,
       0.04333540121447449, 0.043318084371853464, 0.04331540511844079, 0.043355022595564195, 0.043311654397648225,
       0.043306143939002485, 0.043350861754176045, 0.04330166424663106, 0.04331069495067123, 0.04332846329231893,
       0.043302845179049435, 0.0433110920635383, 0.04331509111649241, 0.04336493788671888, 0.043351743431869615,
       0.043305039806060555, 0.04334142134517185, 0.04330469572470208, 0.043302165113451065, 0.04336858380678271,
       0.04330672591555217, 0.04334943131967024, 0.04332516691839892, 0.043304815642104665, 0.04329399818415977,
       0.04330190709861349, 0.04329794245071648, 0.043310409396394224, 0.04330923823901445, 0.04330667009777274,
       0.04329993304881183, 0.043308958703698205, 0.04335158324438678, 0.04329791617356549, 0.04330018786174699]
lstm = [0.04423580187842373, 0.04427859439583849, 0.04422321620066304, 0.04424403278418809, 0.04414970461617817,
        0.044130217561051864, 0.044079958746009625, 0.044074668033310206, 0.04406440051749718, 0.04410106086841792,
        0.044044389935933854, 0.04408957282743178, 0.0440409314964921, 0.04403871009972962, 0.04403697973317351,
        0.04403814391717931, 0.044037978973024146, 0.0440374211338926, 0.04403716607465724, 0.04409310015395653,
        0.04404211695467638, 0.04403681258771045, 0.04405031368629006, 0.04405367260506331, 0.044055914706435086,
        0.044054246853944684, 0.0440477051979993, 0.04405153795214724, 0.044046200996588084, 0.04403876779554797,
        0.04405140501162237, 0.044037830931219185, 0.04404468058554594, 0.04406342222855603, 0.04405620575628497,
        0.04405269194548288, 0.044037274292801035, 0.044035803603608745, 0.044061821138809534, 0.04404320626342592,
        0.04404043884994077, 0.044035368437363095, 0.04403830128760377, 0.044061206111853775, 0.04407260473047899,
        0.044037894199579215, 0.044043986450049505, 0.044044156674264874, 0.044039683708967256, 0.04404553943429111,
        0.044049242542179165, 0.04405654902177409, 0.044093006498311174, 0.0440822282020957, 0.04410981183702296,
        0.0440395148394029, 0.044042407804407366, 0.04407479272277887, 0.04403828276890861, 0.044050818386156695,
        0.04406594174090496, 0.04403543486144425, 0.04403940480479524, 0.04403723209850059, 0.04404177425875644,
        0.04404671376278578, 0.044043534966416595, 0.044048476225334754, 0.04406357781330416, 0.044039368229217765,
        0.04404435799387861, 0.0441298621806724, 0.044057527633984225, 0.04407214470330841, 0.044041655388129645,
        0.04403586240777792, 0.04406905890065284, 0.0440437184754482, 0.04403799305831598, 0.04404098166476104,
        0.04404055200948203, 0.04405868733840541, 0.04404982553471711, 0.044054692564917, 0.04406751198155328,
        0.0440519005829884, 0.044092118232087654, 0.044051474191186844, 0.044045092553392916, 0.04404599867637985,
        0.04407443745015574, 0.04405387386310199, 0.04403768813868692, 0.04404727150955476, 0.044036138633435425,
        0.04403565734748013, 0.04404634331191374, 0.044039277806262336, 0.044036615054962064, 0.044043862622631484]
seq2seq = [0.03044896258795557, 0.029395063569353633, 0.028595494429680925, 0.028365876217765255, 0.027502693636111977,
           0.02768157855107272, 0.026914957864594854, 0.027347601180480532, 0.027387619003160925, 0.02773369072112909,
           0.027878246508723448, 0.027046388523145157, 0.028521802199404103, 0.027480320142936117, 0.028160311035380876,
           0.027273691405565285, 0.027050343719272573, 0.02698881756360373, 0.02714170132232599, 0.027127515016631645,
           0.027259915020347626, 0.028450347144495357, 0.027413032718064372, 0.027884495190598747, 0.027876974984018272,
           0.027037665278704697, 0.02727077913678382, 0.02721091895556647, 0.02841267108239911, 0.027215574213788528,
           0.027079830069310407, 0.027722767638889225, 0.02724114785448086, 0.027043440171386584, 0.02751299266295492,
           0.02751475429424077, 0.02785357780569841, 0.028011818547263617, 0.027159782003395815, 0.026944535237944815,
           0.02764250501251418, 0.02713551681704265, 0.02810620958339577, 0.027762159966855996, 0.027130828616170843,
           0.027355200587964253, 0.027214972717949183, 0.02715345552144957, 0.027293485766353685, 0.027177205555571998,
           0.027081074393238903, 0.027582618123120514, 0.02705357423868061, 0.02725361082856813, 0.027525042499269337,
           0.02732729465385114, 0.027973525472416366, 0.028003528744967515, 0.0272222011819605, 0.027256565260862516,
           0.027304377699317026, 0.027451737160401897, 0.027162572599885876, 0.027274114626251962, 0.027078497446765583,
           0.02722688735085578, 0.027866590691130025, 0.02753413505544347, 0.02699801553625706, 0.027579654423781665,
           0.02702322419086271, 0.0272702590123681, 0.02714793593430322, 0.027241482484069737, 0.02769419710990811,
           0.027739350075933557, 0.02753175327107926, 0.027008710983247797, 0.027634133792613164, 0.02696999521110176,
           0.027397305435262434, 0.027237418623379438, 0.02790295598982287, 0.027167257860549226, 0.02725186800845891,
           0.027474984634390548, 0.02739259805376372, 0.027127886622035798, 0.027483617902294664, 0.02837549573318525,
           0.026998586413904655, 0.027282566494069807, 0.027390535674558198, 0.02731567824428732, 0.027079292580731645,
           0.02730804521682834, 0.02726477230629645, 0.027000910225362818, 0.027616472021976778, 0.026960797253842195]
DAE_Seq2Seq = [0.02463660195993244, 0.024342583915726704, 0.020680745216933163, 0.016287688635412818,
               0.01595216459202126, 0.01586989147496248, 0.015887024785461258, 0.016102789955075122,
               0.01614977398594795, 0.015961283236772806, 0.015837017777722236, 0.015548342023014037,
               0.016076768490616695, 0.015662586458858627, 0.01579929291355339, 0.015569306021048264,
               0.015747230338348336, 0.015596458588318884, 0.01562855841807467, 0.015672162610052293,
               0.015515049934879807, 0.01591085586004144, 0.015484614467078989, 0.015488976778170047,
               0.01582945290999102, 0.015510814541504403, 0.015560981902209196, 0.015414910514123184,
               0.015597969216625552, 0.015921582794971457, 0.01545905552358051, 0.0154727585844634,
               0.015551980226954892, 0.015585515301766967, 0.015617003102502055, 0.015542671873334272,
               0.015489183150786014, 0.016098105625734348, 0.015482690874179287, 0.015337510215318647,
               0.01546921266612312, 0.015639464540237732, 0.015369656226359123, 0.015396925624583132,
               0.015353624543467583, 0.015412699835267196, 0.015363832916448678, 0.015472871859457867,
               0.015395570015303853, 0.015477507352090079, 0.015384502943666759, 0.015575130269978164,
               0.01550375858768205, 0.015394470939212593, 0.01546989746145473, 0.015446812661041406,
               0.015485360348704924, 0.015419021949233594, 0.015341472400213815, 0.015626495076759048,
               0.015572085199215688, 0.015554775279938928, 0.01546706506320514, 0.01531493844279696,
               0.015645723709113095, 0.015648285115584117, 0.015387514205880401, 0.0154756597851303,
               0.015394612711908158, 0.015610830885288883, 0.015523539394263394, 0.01571285197018715,
               0.015504956857324385, 0.01550288411042045, 0.015325827435551843, 0.015360136093063788,
               0.01540759459815242, 0.015519791375075982, 0.015352362170353654, 0.015313670785774378,
               0.015611179257658396, 0.015301563492244926, 0.015350314807762538, 0.015427372395253379,
               0.015483864098171558, 0.015451560701312851, 0.015349070868678084, 0.015472008746640741,
               0.01538139760247932, 0.01544697855960978, 0.015586789962951063, 0.015467647428447303,
               0.015347388253570342, 0.015481446684946207, 0.015279017257973674, 0.01528407368531897,
               0.015452827681009928, 0.015313998538200275, 0.01565821710127321, 0.01531907869502902]
Attention_Seq2Seq = [0.05111950275696014, 0.04398875572710983, 0.04383229787561519, 0.04378964359417927,
                     0.04380727559328079, 0.04375670664012432, 0.04402699831041915, 0.04386949602298993,
                     0.04383715343746272, 0.04382254443446959, 0.04384326654647993, 0.04365855169074594,
                     0.04375337977116266, 0.043867656622420655, 0.043600423600186004, 0.043725587366041076,
                     0.043750984009262944, 0.04346475160626833, 0.04356700720742714, 0.04370313722732638,
                     0.044122234294729785, 0.04385468212903038, 0.04393143462371235, 0.043860372217479814,
                     0.04363407950448103, 0.043800301972992166, 0.04390382648191669, 0.04372412865319528,
                     0.04390422624251074, 0.04401371962090662, 0.043858657183110224, 0.04367823132182941,
                     0.043927096338434654, 0.04354752247675884, 0.043891392171013455, 0.044157261336761074,
                     0.04388624166469436, 0.043818280177791255, 0.04381482172295574, 0.04398150872900959,
                     0.04351964338936589, 0.044052103719065996, 0.043719261946264375, 0.04372057641956432,
                     0.04399989560739068, 0.04421345817217649, 0.043809747969931805, 0.043942875082581496,
                     0.043475854310615, 0.043657027169569464, 0.04373536677646243, 0.04375563943681638,
                     0.04371069113085092, 0.043755099177360535, 0.04385359763852821, 0.04399685640165136,
                     0.043794704616562395, 0.04392406584556438, 0.04395688469868061, 0.043623522293469136,
                     0.04386571085095898, 0.04384767789055, 0.04379303636383419, 0.044093983001575986,
                     0.043617663058367645, 0.0437555868825144, 0.04365668813736478, 0.043744249069247364,
                     0.043811110918186916, 0.04398438018892915, 0.04384893640752666, 0.043510681141383394,
                     0.04388702203604308, 0.04382501930490998, 0.0438561418732582, 0.044107791821449256,
                     0.04378163874580348, 0.04387526260304057, 0.04357232904631244, 0.0438977875400427,
                     0.043286280152349435, 0.04394331432817396, 0.043816245876806825, 0.04398184600632545,
                     0.04376655010398754, 0.0437605905631357, 0.043654161913335814, 0.04338568704556828,
                     0.04398421455205472, 0.043694054353828275, 0.04388019190100599, 0.04387556362804795,
                     0.04354437976336676, 0.043677338514446225, 0.0436806008989407, 0.04360626771861364,
                     0.04354607292320117, 0.0435939095452551, 0.04368509681633681, 0.04370628788389943]

epoches = np.arange(1, 101)

plt.figure(figsize=(8, 4.9))
plt.plot(epoches, our_APE, label='Test loss', color='r', linewidth=1)
plt.plot(epoches, our_APE_1, label='Train loss', color='#FA8072',  linewidth=1)
plt.plot(epoches, lstm, label='LSTM', color='#98FB98',  linewidth=1)
plt.plot(epoches, seq2seq, label='Seq2Seq', color='#800080',  linewidth=1)
plt.plot(epoches, DAE_Seq2Seq, label='DAE_Seq2Seq', color='#FA8072',  linewidth=1)
plt.plot(epoches, Attention_Seq2Seq, label='Attention_Seq2Seq', color='#87CEEB', linewidth=1)

plt.xlabel('Epoches')
plt.ylabel('Loss')
plt.legend()
plt.show()
